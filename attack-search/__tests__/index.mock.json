[
  {
    "id": 0,
    "title": "404",
    "path": "/404.html",
    "content": " 404 Oh no! It looks like the page you're looking for doesn't exist. If you think you reached this page because of an error, please create an issue on our GitHub Issue Tracker! "
  },
  {
    "id": 1,
    "title": "Script, Data Source DS0012",
    "path": "/datasources/DS0012/index.html",
    "content": " Script A file or stream containing a list of commands, allowing them to be launched in sequence[1][2][3] ID: DS0012 \u24d8 Platform: Windows \u24d8 Collection Layer: Host Contributors: Center for Threat-Informed Defense (CTID) Version: 1.1 Created: 20 October 2021 Last Modified: 21 October 2022 Data Components Script: Script Execution The execution of a text file that contains code via the interpreter (e.g. Powershell, WMI, Windows EID 4104, etc.) Script: Script Execution The execution of a text file that contains code via the interpreter (e.g. Powershell, WMI, Windows EID 4104, etc.) Domain ID Name Detects Enterprise T1560 Archive Collected Data Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. .002 Archive via Library Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. .003 Archive via Custom Method Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Enterprise T1119 Automated Collection Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ICS T0802 Automated Collection Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible, to determine their actions and intent. Enterprise T1020 Automated Exfiltration Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Enterprise T1059 Command and Scripting Interpreter Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. .001 PowerShell Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. .005 Visual Basic Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. .007 JavaScript Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. ICS T0811 Data from Information Repositories In the case of detecting collection from local systems monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Data may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. For added context on adversary procedures and background see Data from Local System. Enterprise T1005 Data from Local System Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Data may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell. Enterprise T1140 Deobfuscate/Decode Files or Information Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Enterprise T1482 Domain Trust Discovery Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Enterprise T1615 Group Policy Discovery Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Enterprise T1564 Hide Artifacts Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. .003 Hidden Window Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. .007 VBA Stomping Detection efforts should be placed finding differences between VBA source code and p-code.[4] VBA code can be extracted from p-code before execution with tools such as the pcodedmp disassembler. The oletools toolkit leverages the pcodedmp disassembler to detect VBA stomping by comparing keywords present in the VBA source code and p-code.[5][6] Enterprise T1562 Impair Defenses Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. .002 Disable Windows Event Logging Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Enterprise T1056 .002 Input Capture: GUI Input Capture Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Enterprise T1559 Inter-Process Communication Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. .001 Component Object Model Monitor for any attempts to enable scripts running on a system would be considered suspicious. Enumeration of COM objects, via Query Registry or PowerShell, may also proceed malicious use.[7][8] .002 Dynamic Data Exchange Monitor for any attempts to enable scripts running on a system would be considered suspicious. OLE and Office Open XML files can be scanned for \u2018DDEAUTO', \u2018DDE\u2019, and other strings indicative of DDE execution.https://blog.nviso.be/2017/10/11/detecting-dde-in-ms-office-documents/ Enterprise T1556 .005 Modify Authentication Process: Reversible Encryption Consider monitoring and/or blocking suspicious execution of Active Directory PowerShell modules, such as Set-ADUser and Set-ADAccountControl, that change account configurations. ICS T0840 Network Connection Enumeration Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Enterprise T1620 Reflective Code Loading Similarly, AMSI / ETW traces can be used to identify signs of arbitrary code execution from within the memory of potentially compromised processes.[9][10] ICS T0853 Scripting Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Enterprise T1016 System Network Configuration Discovery Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. Enterprise T1216 System Script Proxy Execution Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. .001 PubPrn Monitor for any attempts to enable scripts running on a system would be considered suspicious. If scripts are not commonly used on a system, but enabled, scripts running out of cycle from patching or other administrator functions are suspicious. Scripts should be captured from the file system when possible to determine their actions and intent. References Microsoft. (2020, March 30). about_Logging_Windows. Retrieved September 28, 2021. Dunwoody, M. (2016, February 11). Greater Visibility Through PowerShell Logging. Retrieved September 28, 2021. Microsoft. (2019, April 19). Antimalware Scan Interface (AMSI). Retrieved September 28, 2021. Sayre, K., Ogden, H., Roberts, C. (2018, October 10). VBA Stomping \u2014 Advanced Maldoc Techniques. Retrieved September 17, 2020. Bontchev, V. (2019, July 30). pcodedmp.py - A VBA p-code disassembler. Retrieved September 17, 2020. decalage2. (2019, December 3). python-oletools. Retrieved September 18, 2020. Hamilton, C. (2019, June 4). Hunting COM Objects. Retrieved June 10, 2019. Nelson, M. (2017, January 5). Lateral Movement using the MMC20 Application COM Object. Retrieved November 21, 2017. MDSec Research. (n.d.). Detecting and Advancing In-Memory .NET Tradecraft. Retrieved October 4, 2021. The Wover. (2019, May 9). Donut - Injecting .NET Assemblies as Shellcode. Retrieved October 4, 2021. "
  },
  {
    "id": 199,
    "title": "Equation, Group G0020",
    "path": "/groups/G0020/index.html",
    "content": " Equation Equation is a sophisticated threat group that employs multiple remote access tools. The group is known to use zero-day exploits and has developed the capability to overwrite the firmware of hard disk drives. [1] ID: G0020 Version: 1.2 Created: 31 May 2017 Last Modified: 29 June 2020 Techniques Used Domain ID Name Use Enterprise T1480 .001 Execution Guardrails: Environmental Keying Equation has been observed utilizing environmental keying in payload delivery.[2][1] Enterprise T1564 .005 Hide Artifacts: Hidden File System Equation has used an encrypted virtual file system stored in the Windows Registry.[1] Enterprise T1120 Peripheral Device Discovery Equation has used tools with the functionality to search for specific information about the attached hard drive that could be used to identify and overwrite the firmware.[1] Enterprise T1542 .002 Pre-OS Boot: Component Firmware Equation is known to have the capability to overwrite the firmware on hard drives from some manufacturers.[1] References Kaspersky Lab's Global Research and Analysis Team. (2015, February). Equation Group: Questions and Answers. Retrieved December 21, 2015. Kaspersky Lab. (2012, August). Gauss: Abnormal Distribution. Retrieved January 17, 2019. "
  },
  {
    "id": 702,
    "title": "Azorult, Software S0344",
    "path": "/software/S0344/index.html",
    "content": " Azorult Azorult is a commercial Trojan that is used to steal information from compromised hosts. Azorult has been observed in the wild as early as 2016.In July 2018, Azorult was seen used in a spearphishing campaign against targets in North America. Azorult has been seen used for cryptocurrency theft. [1][2] ID: S0344 \u24d8 Type: MALWARE \u24d8 Platforms: Windows Version: 1.3 Created: 30 January 2019 Last Modified: 13 October 2022 Techniques Used Domain ID Name Use Enterprise T1134 .002 Access Token Manipulation: Create Process with Token Azorult can call WTSQueryUserToken and CreateProcessAsUser to start a new process with local system privileges.[1] Enterprise T1555 .003 Credentials from Password Stores: Credentials from Web Browsers Azorult can steal credentials from the victim's browser.[1] Enterprise T1140 Deobfuscate/Decode Files or Information Azorult uses an XOR key to decrypt content and uses Base64 to decode the C2 address.[1][2] Enterprise T1573 .001 Encrypted Channel: Symmetric Cryptography Azorult can encrypt C2 traffic using XOR.[1][2] Enterprise T1083 File and Directory Discovery Azorult can recursively search for files in folders and collects files from the desktop with certain extensions.[1] Enterprise T1070 .004 Indicator Removal: File Deletion Azorult can delete files from victim machines.[1] Enterprise T1105 Ingress Tool Transfer Azorult can download and execute additional files. Azorult has also downloaded a ransomware payload called Hermes.[1][2] Enterprise T1057 Process Discovery Azorult can collect a list of running processes by calling CreateToolhelp32Snapshot.[1][2] Enterprise T1055 .012 Process Injection: Process Hollowing Azorult can decrypt the payload into memory, create a new suspended process of itself, then inject a decrypted payload to the new process and resume new process execution.[1] Enterprise T1012 Query Registry Azorult can check for installed software on the system under the Registry key Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall.[1] Enterprise T1113 Screen Capture Azorult can capture screenshots of the victim\u2019s machines.[1] Enterprise T1082 System Information Discovery Azorult can collect the machine information, system architecture, the OS version, computer name, Windows product name, the number of CPU cores, video card information, and the system language.[1][2] Enterprise T1016 System Network Configuration Discovery Azorult can collect host IP information from the victim\u2019s machine.[1] Enterprise T1033 System Owner/User Discovery Azorult can collect the username from the victim\u2019s machine.[1] Enterprise T1124 System Time Discovery Azorult can collect the time zone information from the system.[1][2] Enterprise T1552 .001 Unsecured Credentials: Credentials In Files Azorult can steal credentials in files belonging to common software such as Skype, Telegram, and Steam.[1] Groups That Use This Software ID Name References G0092 TA505 [3] References Yan, T., et al. (2018, November 21). New Wine in Old Bottle: New Azorult Variant Found in FindMyName Campaign using Fallout Exploit Kit. Retrieved November 29, 2018. Proofpoint. (2018, July 30). New version of AZORult stealer improves loading features, spreads alongside ransomware in new campaign. Retrieved November 29, 2018. Terefos, A. (2020, November 18). TA505: A Brief History of Their Time. Retrieved July 14, 2022. "
  },
  {
    "id": 1283,
    "title": "Remote System Information Discovery, Technique T0888 - ICS",
    "path": "/techniques/T0888/index.html",
    "content": " Remote System Information Discovery An adversary may attempt to get detailed information about remote systems and their peripherals, such as make/model, role, and configuration. Adversaries may use information from Remote System Information Discovery to aid in targeting and shaping follow-on behaviors. For example, the systems operational role and model information can dictate whether it is a relevant target for the adversary's operational objectives. In addition, the systems configuration may be used to scope subsequent technique usage. Requests for system information are typically implemented using automation and management protocols and are often automatically requested by vendor software during normal operation. This information may be used to tailor management actions, such as program download and system or module firmware. An adversary may leverage this same information by issuing calls directly to the systems API. ID: T0888 \u24d8 Tactic: Discovery \u24d8 Platforms: Field Controller/RTU/PLC/IED, Safety Instrumented System/Protection Relay Version: 1.1 Created: 13 April 2021 Last Modified: 26 September 2022 Procedure Examples ID Name Description S0093 Backdoor.Oldrea The Backdoor.Oldrea payload gathers server information that includes CLSID, server name, Program ID, OPC version, vendor information, running state, group count, and server bandwidth. This information helps indicate the role the server has in the control process. [1] [2] S1045 INCONTROLLER INCONTROLLER includes a library that creates Modbus connections with a device to request its device ID.[3][4] S0604 Industroyer The Industroyer IEC 61850 componentsends the domain-specific MMSgetNameListrequest to determine what logical nodes the device supports. It then searches the logical nodes for the CSW value, which indicates the device performs a circuit breaker or switch control function.[5] Industroyer's OPC DA module also uses IOPCBrowseServerAddressSpace to look for items with the following strings: ctlSelOn, ctlOperOn, ctlSelOff, ctlOperOff, Pos and stVal.[5] Industroyer IEC 60870-5-104 module includes a range mode to discover Information Object Addresses (IOAs) by enumerating through each.[5] S0603 Stuxnet Stuxnet enumerates and parses the System Data Blocks (SDB) using the s7blk_findfirst and s7blk_findnext API calls in s7otbxdx.dll. Stuxnet must find an SDB with the DWORD at offset 50h equal to 0100CB2Ch. This specifies that the system uses the Profibus communications processor module CP 342-5. In addition, specific values are searched for and counted: 7050h and 9500h. 7050h is assigned to part number KFC750V3 which appears to be a frequency converter drive (also known as variable frequency drive) manufactured by Fararo Paya in Teheran, Iran. 9500h is assigned to Vacon NX frequency converter drives manufactured by Vacon based in Finland.[6] Stuxnet was specifically targeting CPUs 6ES7-315-2 (Series 300) with special system data block characteristics for sequence A or B and 6ES7-315-2 for sequence C. The PLC type can also be checked using the s7ag_read_szl API.[6] Mitigations ID Mitigation Description M0814 Static Network Configuration ICS environments typically have more statically defined devices, therefore minimize the use of both IT discovery protocols (e.g., DHCP, LLDP) and discovery functions in automation protocols. [7] [8] Examples of automation protocols with discovery capabilities include OPC UA Device Discovery [9], BACnet [10], and Ethernet/IP. [11] Detection ID Data Source Data Component Detects DS0022 File File Access Monitor for files (such as /etc/hosts) being accessed that may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. DS0029 Network Traffic Network Traffic Content Monitor for anomalies related to discovery related ICS functions, including devices that have not previously used these functions or for functions being sent to many outstations. Note that some ICS protocols use broadcast or multicast functionality, which may produce false positives. Also monitor for hosts enumerating network connected resources using non-ICS enterprise protocols. Network Traffic Flow Monitor for new ICS protocol connections to existing assets or for device scanning (i.e., a host connecting to many devices) over ICS and enterprise protocols (e.g., ICMP, DCOM, WinRM). DS0009 Process Process Creation Monitor for newly executed processes that can be used to discover remote systems, such as ping.exe and tracert.exe, especially when executed in quick succession.[12] Consider monitoring for new processes engaging in scanning activity or connecting to multiple systems by correlating process creation network data. References ICS-CERT 2018, August 22 Advisory (ICSA-14-178-01) Retrieved. 2019/04/01 Daavid Hentunen, Antti Tikkanen 2014, June 23 Havex Hunts For ICS/SCADA Systems Retrieved. 2019/04/01 DHS/CISA. (2022, May 25). Alert (AA22-103A) APT Cyber Tools Targeting ICS/SCADA Devices. Retrieved September 28, 2022. Jimmy Wylie. (2022, August). Analyzing PIPEDREAM: Challenges in Testing an ICS Attack Toolkit. Defcon 30. Anton Cherepanov. (2017, June 12). Win32/Industroyer: A new threat for industrial controls systems. Retrieved December 18, 2020. Nicolas Falliere, Liam O Murchu, Eric Chien 2011, February W32.Stuxnet Dossier (Version 1.4) Retrieved. 2017/09/22 D. Parsons and D. Wylie 2019, September Practical Industrial Control System (ICS) Cybersecurity: IT and OT Have Converged Discover and Defend Your Assets Retrieved. 2020/09/25 Colin Gray D. Parsons and D. Wylie 2019, September Practical Industrial Control System (ICS) Cybersecurity: IT and OT Have Converged Discover and Defend Your Assets Retrieved. 2020/09/25 How SDN Can Improve Cybersecurity in OT Networks Retrieved. 2020/09/25 Josh Rinaldi 2016, April Still a Thrill: OPC UA Device Discovery Retrieved. 2020/09/25 Aditya K Sood 2019, July Discovering and fingerprinting BACnet devices Retrieved. 2020/09/25 Langner 2018, November Why Ethernet/IP changes the OT asset discovery game Retrieved. 2020/09/25 Stepanic, D.. (2020, January 13). Embracing offensive tooling: Building detections against Koadic using EQL. Retrieved November 30, 2020. "
  }
]
